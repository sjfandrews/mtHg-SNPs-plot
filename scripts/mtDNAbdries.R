library(tibble)

# tibble defining boundries of features of the mtDNA
# https://www.ncbi.nlm.nih.gov/nuccore/251831106
bdries <- tribble(
  ~gene, ~start, ~end, ~strand, ~feature,
  'D-loop', 1, 576, "+", 'D-loop', 
  'D-loop', 16024, 16569, "+", 'D-loop', 
  'tRNA', 577, 647, "+", 'tRNA',
  "rRNA", 648, 1601, "+", "rRNA",
  "tRNA", 1602, 1670, "+",'tRNA',
  "rRNA",  1671, 3229, "+", "rRNA",
  "tRNA", 3230, 3304, "+", 'tRNA',
  "ND1", 3307, 4262, "+", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "tRNA", 4263, 4331,"+", 'tRNA',
  "tRNA", 4329, 4400, "-", 'tRNA',
  "tRNA", 4402, 4469, "+", 'tRNA',
  "ND2", 4470, 5511, "+", "ND1, ND2, ND3, ND4L, ND5, ND6",
  "tRNA", 5512, 5579, "+", 'tRNA',
  "tRNA", 5587, 5655, "-", 'tRNA',
  "tRNA", 5657, 5729, "-", 'tRNA',
  "tRNA", 5761, 5826, "-", 'tRNA',
  "tRNA", 5826, 5891, "-", 'tRNA',
  "COX1", 5904, 7445, "+",  "COX1, COX2, COX3", 
  "tRNA", 7446, 7514, "-", 'tRNA',
  "tRNA", 7518, 7585, "+", 'tRNA',
  "COX2", 7586, 8269, "+", "COX1, COX2, COX3", 
  "tRNA", 8295, 8364, "+", 'tRNA',
  "ATP8", 8366, 8572, "+", "ATP6, ATP8", 
  "ATP6", 8527, 9207, "+", "ATP6, ATP8", 
  "COX3", 9207, 9990, "+", "COX1, COX2, COX3", 
  "tRNA", 9991, 10058, "+", 'tRNA',
  "ND3", 10059, 10404, "+", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "tRNA", 10405, 10469, "+", 'tRNA',
  "ND4L", 10470, 10766, "+", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "ND4", 10760, 12137, "+", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "tRNA", 12138, 12206, "+", 'tRNA',
  "tRNA", 12207, 12265, "+", 'tRNA',
  "tRNA", 12266, 12336, "+", 'tRNA',
  "ND5", 12337, 14148, "+", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "ND6", 14149, 14673, "-", "ND1, ND2, ND3, ND4L, ND5, ND6", 
  "tRNA", 14674, 14742, "-", 'tRNA',
  "CYTB", 14747, 15887, "+", "CYTB", 
  "tRNA", 15888, 15953, "+", 'tRNA',
  "tRNA", 15956, 16023, "-", 'tRNA'
) 

# Sets gene names for bp ranges
# adapted from https://github.com/stephenturner/solarplot
addgenelabel <- function(pos){
  case_when(
    between(pos, 0, 576) ~ "D-loop", 
    between(pos, 577, 647) ~ "tRNA",      
    between(pos, 648, 1601) ~ "rRNA",     
    between(pos, 1602, 1670) ~ "tRNA",    
    between(pos, 1671, 3229) ~ "rRNA",    
    between(pos, 3230, 3304) ~ "tRNA",    
    between(pos, 3307, 4262) ~ "ND1",     
    between(pos, 4263, 4331) ~ "tRNA",    
    between(pos, 4329, 4400) ~ "tRNA",    
    between(pos, 4402, 4469) ~ "tRNA",    
    between(pos, 4470, 5511) ~ "ND2",     
    between(pos, 5512, 5579) ~ "tRNA",    
    between(pos, 5587, 5655) ~ "tRNA",    
    between(pos, 5657, 5729) ~ "tRNA",    
    between(pos, 5761, 5826) ~ "tRNA",    
    between(pos, 5826, 5891) ~ "tRNA",    
    between(pos, 5904, 7445) ~ "COX1",    
    between(pos, 7446, 7514) ~ "tRNA",    
    between(pos, 7518, 7585) ~ "tRNA",    
    between(pos, 7586, 8269) ~ "COX2",    
    between(pos, 8295, 8364) ~ "tRNA",    
    between(pos, 8366, 8572) ~ "ATP8",    
    between(pos, 8527, 9207) ~ "ATP6",    
    between(pos, 9207, 9990) ~ "COX3",    
    between(pos, 9991, 10058) ~ "tRNA",   
    between(pos, 10059, 10404) ~ "ND3",   
    between(pos, 10405, 10469) ~ "tRNA",  
    between(pos, 10470, 10766) ~ "ND4L",  
    between(pos, 10760, 12137) ~ "ND4",   
    between(pos, 12138, 12206) ~ "tRNA",  
    between(pos, 12207, 12265) ~ "tRNA",  
    between(pos, 12266, 12336) ~ "tRNA",  
    between(pos, 12337, 14148) ~ "ND5",   
    between(pos, 14149, 14673) ~ "ND6",   
    between(pos, 14674, 14742) ~ "tRNA",  
    between(pos, 14747, 15887) ~ "CYTB",  
    between(pos, 15888, 15953) ~ "tRNA" , 
    between(pos, 15956, 16023) ~ "tRNA", 
    between(pos, 16024, 16569) ~ "D-loop",
  )
}


